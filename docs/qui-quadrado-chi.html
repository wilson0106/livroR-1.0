<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 3 Qui-quadrado (\(\chi\)²) | Introdução à análise de dados em R: Uma abordagem ambiental</title>
  <meta name="description" content="Este é o primeiro livro da série de livros: Análise de dados em R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 3 Qui-quadrado (\(\chi\)²) | Introdução à análise de dados em R: Uma abordagem ambiental" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este é o primeiro livro da série de livros: Análise de dados em R" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 3 Qui-quadrado (\(\chi\)²) | Introdução à análise de dados em R: Uma abordagem ambiental" />
  
  <meta name="twitter:description" content="Este é o primeiro livro da série de livros: Análise de dados em R" />
  

<meta name="author" content="Wilson Souza &amp; Thiago Couto" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="importar-organizar-e-sumarizar-os-dados.html"/>
<link rel="next" href="teste-t.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introdução à Análise de Dados em R: Uma Abordagem Ambiental</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estrutura-do-livro"><i class="fa fa-check"></i>Estrutura do livro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#agradecimentos"><i class="fa fa-check"></i>Agradecimentos</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a></li>
<li class="chapter" data-level="1" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>1</b> R</a><ul>
<li class="chapter" data-level="1.1" data-path="r.html"><a href="r.html#o-que-é"><i class="fa fa-check"></i><b>1.1</b> O que é?</a></li>
<li class="chapter" data-level="1.2" data-path="r.html"><a href="r.html#porque-usar-o-r-para-análise-de-dados"><i class="fa fa-check"></i><b>1.2</b> Porque usar o R para análise de dados?</a></li>
<li class="chapter" data-level="1.3" data-path="r.html"><a href="r.html#o-rstudio"><i class="fa fa-check"></i><b>1.3</b> O RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="r.html"><a href="r.html#exercícios"><i class="fa fa-check"></i><b>1.4</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html"><i class="fa fa-check"></i><b>2</b> Importar, organizar e sumarizar os dados</a><ul>
<li class="chapter" data-level="2.1" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#passo-definir-o-ambiente-de-trabalho-e-importar-a-planilha-de-dados-para-o-r"><i class="fa fa-check"></i><b>2.1</b> 1° passo: Definir o ambiente de trabalho e importar a planilha de dados para o R</a><ul>
<li class="chapter" data-level="2.1.1" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#definindo-ambiente-de-trabalho-via-linha-de-comando"><i class="fa fa-check"></i><b>2.1.1</b> Definindo ambiente de trabalho via linha de comando</a></li>
<li class="chapter" data-level="2.1.2" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#definindo-ambiente-de-trabalho-via-interface-gráfica"><i class="fa fa-check"></i><b>2.1.2</b> Definindo ambiente de trabalho via interface gráfica</a></li>
<li class="chapter" data-level="2.1.3" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#importando-planilha-via-linha-de-comando"><i class="fa fa-check"></i><b>2.1.3</b> Importando planilha via linha de comando:</a></li>
<li class="chapter" data-level="2.1.4" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#importando-planilha-via-interface-gráfica"><i class="fa fa-check"></i><b>2.1.4</b> Importando planilha via interface gráfica:</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#passo-verificar-e-ajustar-os-dados"><i class="fa fa-check"></i><b>2.2</b> 2° passo: Verificar e ajustar os dados</a></li>
<li class="chapter" data-level="2.3" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#passo-sumarizar-os-dados-graficamente"><i class="fa fa-check"></i><b>2.3</b> 3° passo: Sumarizar os dados graficamente</a><ul>
<li class="chapter" data-level="2.3.1" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#histograma"><i class="fa fa-check"></i><b>2.3.1</b> Histograma</a></li>
<li class="chapter" data-level="2.3.2" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#gráfico-de-barras"><i class="fa fa-check"></i><b>2.3.2</b> Gráfico de Barras</a></li>
<li class="chapter" data-level="2.3.3" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#gráfico-de-pontos-e-de-linhas"><i class="fa fa-check"></i><b>2.3.3</b> Gráfico de Pontos e de Linhas</a></li>
<li class="chapter" data-level="2.3.4" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#boxplot"><i class="fa fa-check"></i><b>2.3.4</b> Boxplot</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#passo-sumarizar-os-dados-numericamente"><i class="fa fa-check"></i><b>2.4</b> 4° passo: Sumarizar os dados numericamente</a></li>
<li class="chapter" data-level="2.5" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#considerações"><i class="fa fa-check"></i><b>2.5</b> Considerações</a></li>
<li class="chapter" data-level="2.6" data-path="importar-organizar-e-sumarizar-os-dados.html"><a href="importar-organizar-e-sumarizar-os-dados.html#exercícios-1"><i class="fa fa-check"></i><b>2.6</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="qui-quadrado-chi.html"><a href="qui-quadrado-chi.html"><i class="fa fa-check"></i><b>3</b> Qui-quadrado (<span class="math inline">\(\chi\)</span>²)</a><ul>
<li class="chapter" data-level="3.1" data-path="qui-quadrado-chi.html"><a href="qui-quadrado-chi.html#chi-para-ajuste-de-frequências"><i class="fa fa-check"></i><b>3.1</b> <span class="math inline">\(\chi\)</span>² para ajuste de frequências</a></li>
<li class="chapter" data-level="3.2" data-path="qui-quadrado-chi.html"><a href="qui-quadrado-chi.html#chi-para-independência"><i class="fa fa-check"></i><b>3.2</b> <span class="math inline">\(\chi\)</span>² para independência</a></li>
<li class="chapter" data-level="3.3" data-path="qui-quadrado-chi.html"><a href="qui-quadrado-chi.html#considerações-1"><i class="fa fa-check"></i><b>3.3</b> Considerações</a></li>
<li class="chapter" data-level="3.4" data-path="qui-quadrado-chi.html"><a href="qui-quadrado-chi.html#exercícios-2"><i class="fa fa-check"></i><b>3.4</b> Exercícios</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="teste-t.html"><a href="teste-t.html"><i class="fa fa-check"></i><b>4</b> Teste-t</a><ul>
<li class="chapter" data-level="4.1" data-path="teste-t.html"><a href="teste-t.html#teste-t-para-uma-amostra"><i class="fa fa-check"></i><b>4.1</b> Teste-t para uma amostra</a></li>
<li class="chapter" data-level="4.2" data-path="teste-t.html"><a href="teste-t.html#teste-t-para-duas-amostras"><i class="fa fa-check"></i><b>4.2</b> Teste-t para duas amostras</a></li>
<li class="chapter" data-level="4.3" data-path="teste-t.html"><a href="teste-t.html#teste-t-pareado"><i class="fa fa-check"></i><b>4.3</b> Teste-t pareado</a></li>
<li class="chapter" data-level="4.4" data-path="teste-t.html"><a href="teste-t.html#considerações-2"><i class="fa fa-check"></i><b>4.4</b> Considerações</a></li>
<li class="chapter" data-level="4.5" data-path="teste-t.html"><a href="teste-t.html#exercícios-3"><i class="fa fa-check"></i><b>4.5</b> Exercícios</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="resolução-dos-exercícios.html"><a href="resolução-dos-exercícios.html"><i class="fa fa-check"></i><b>A</b> Resolução dos Exercícios</a><ul>
<li class="chapter" data-level="A.1" data-path="resolução-dos-exercícios.html"><a href="resolução-dos-exercícios.html#capítulo-1"><i class="fa fa-check"></i><b>A.1</b> Capítulo 1</a></li>
<li class="chapter" data-level="A.2" data-path="resolução-dos-exercícios.html"><a href="resolução-dos-exercícios.html#capítulo-2"><i class="fa fa-check"></i><b>A.2</b> Capítulo 2</a></li>
<li class="chapter" data-level="A.3" data-path="resolução-dos-exercícios.html"><a href="resolução-dos-exercícios.html#capítulo-3"><i class="fa fa-check"></i><b>A.3</b> Capítulo 3</a></li>
<li class="chapter" data-level="A.4" data-path="resolução-dos-exercícios.html"><a href="resolução-dos-exercícios.html#capítulo-4"><i class="fa fa-check"></i><b>A.4</b> Capítulo 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introdução à análise de dados em R: Uma abordagem ambiental</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="qui-quadrado-chi" class="section level1">
<h1><span class="header-section-number">Capítulo 3</span> Qui-quadrado (<span class="math inline">\(\chi\)</span>²)</h1>
<p>Até o momento aprendemos a definir o ambiente em que iremos trabalhar, importar nossa planilha, verifica-la e ajusta-la se necessário, assim como as métricas mais utilizadas para sumarizar os dados. Mas por vezes estamos interessados em analisar os dados, então vamos começar com o Qui-quadrado.</p>
<p>Em alguns momentos podemos estar trabalhando com variáveis categóricas e lidarmos com perguntas sobre estas variáveis e portanto pode ser necessário avaliarmos se a frequência das observações de uma dada variável categórica ajusta-se ao que se é esperado (<span class="math inline">\(\chi\)</span>² para ajuste de frequências) ou se as proporções das observações de duas ou mais variáveis categóricas são independentes uma da outra (<span class="math inline">\(\chi\)</span>² para independência).</p>
<p>De modo que, para este teste iremos precisar apenas de uma variável (se estivermos avaliando o ajuste de frequências) ou duas variáveis (se avaliarmos a independência) e estas devem ser categóricas. Como aprendemos anteriormente as variáveis categóricas devem ser classificadas como fator (pela função <span style="color: blue;">as.factor()</span>) no R. Vamos conferir em detalhes e com exemplos como realizar estas duas análises no R.</p>
<div id="chi-para-ajuste-de-frequências" class="section level2">
<h2><span class="header-section-number">3.1</span> <span class="math inline">\(\chi\)</span>² para ajuste de frequências</h2>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tab1qui">Tabela 3.1: </span>Principais características do qui-quadrado para ajuste das frequências
</caption>
<thead>
<tr>
<th style="text-align:left;">
Atributos
</th>
<th style="text-align:left;">
Características
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Tipo de variável
</td>
<td style="text-align:left;width: 30em; ">
Categórica
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Quantidade de variáveis
</td>
<td style="text-align:left;width: 30em; ">
1
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Hipótese nula
</td>
<td style="text-align:left;width: 30em; ">
O número de observações em cada grupo da variável é similar ao predito pela teoria
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Fórmula
</td>
<td style="text-align:left;width: 30em; ">
<span class="math display">\[\chi^2=\sum^{N}_{i = 1}\frac{(Ob-Es)^2}{Es}\]</span>
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Observação
</td>
<td style="text-align:left;width: 30em; ">
Se há apenas 2 categorias, dentro da variável, não há a necessidade de post-hoc nem expressa-la graficamente
</td>
</tr>
</tbody>
</table>
<p>Imagine o seguinte exemplo: Você foi a praia e verificou uma enorme quantidade de produtos plásticos, esquecidos pelas pessoas. Após um tempo de observação você percebeu que haviam tanto sacolas quanto tampas de garrafa PET e poderia levantr a seguinte pergunta: Será que se coletarmos estes plásticos na praia e o categorizarmos eles apresentarão quantidades similares? A partir desta pergunta a seguinte hipótese nula (H0) é naturalmente construída: Não há diferenças entre estes dois tipos de plásticos (tampas e sacolas). O <span class="math inline">\(\chi\)</span>² objetiva responder a essa pergunta e fornecer subsídio estatístico para corroborar ou refutar essa hipótese.</p>
<p>Após a observação, coleta, classificação e contagem dos fragmentos plásticos os seguintes valores foram observados: 520 sacolas plásticas e 470 tampas. Dessa forma podemos perguntar: do total de fragmentos coletados (520 para sacolas e 470 para tampas) cada um deles contribuem com 50% (percentuais iguais) do total?</p>
<p>Vamos começar criando 2 vetores<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> onde o primeiro corresponde aos valores observados e o segundo as proporções esperadas para cada valor.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">observados &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">520</span>, <span class="dv">470</span>)</a>
<a class="sourceLine" id="cb80-2" data-line-number="2">esperados &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb80-3" data-line-number="3"></a>
<a class="sourceLine" id="cb80-4" data-line-number="4">observados</a></code></pre></div>
<pre><code>## [1] 520 470</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">esperados</a></code></pre></div>
<pre><code>## [1] 0.5 0.5</code></pre>
<p>Note que criamos os objetos “observados” e “esperados”. O primeiro corresponde ao que coletamos e o segundo as proporções que esperamos de ambos.</p>
<p>Para realizar o teste do <span class="math inline">\(\chi\)</span>² para ajuste de frequências, vamos utilizar a função <span style="color: blue;">chisq.test()</span>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw">chisq.test</span>(<span class="dt">x =</span> observados, <span class="dt">p =</span> esperados)</a></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  observados
## X-squared = 2.5253, df = 1, p-value = 0.112</code></pre>
<p>Esta função utiliza 2 argumentos:
* x: no qual inserimos o vetor númerico que contém os valores referentes a quantidade da variável nominal que contabilizamos;
* p: no qual inserimos o vetor númerico que contem as proporções esperadas associado a cada grupo da categoria avaliada.</p>
<p>Note que o resultado indica o teste realizado, o nome do objeto que contém os dados e na terceira linha ele apresenta o resultado como valor do teste do <span class="math inline">\(\chi\)</span>², o grau de liberdade (<em>df</em> do inglês <em>degrees of freedom</em>) e o valor de probabilidade associado (do inglês <em>p-value</em>).</p>
<p>Uma característica do <span class="math inline">\(\chi\)</span>² é que quanto mais similares forem os valores observados menor será o valor do <span class="math inline">\(\chi\)</span>², mas nunca menor que 0 e com o <em>p-value</em> máximo igual a 1 e quanto mais dissimilares forem os valores observados maior será o <span class="math inline">\(\chi\)</span>² (tendendo a infinito) e menor será o <em>p-value</em> (tendendo a 0)</p>
<p>Com isso podemos observar que o <span class="math inline">\(\chi\)</span>² varia entre (0 e + infinito) enquanto que o <em>p-value</em> varia entre (0 e 1) com uma relação inversa entre eles. Quanto maior o <span class="math inline">\(\chi\)</span>² menor o <em>p-value</em> e quanto menor o <span class="math inline">\(\chi\)</span>² maior o <em>p-value</em>.</p>
<p>Por convenção indicamos que um teste estatístico que apresenta <em>p-value</em> &lt; 0,05 indica diferenças significativas entre os valores observados. Dessa forma, assumindo essa convenção, podemos concluir que a quantidade de sacolas não difere da quantidade de tampas de garrafa PET. Portanto aceitamos a hipótese nula.</p>
<p>Não é comum representar o resultado deste teste graficamente apenas como valor mas se mesmo assim quiser representa-lo utilize um gráfico de barras.</p>
<p>Vamos verificar outros exemplos e avaliar suas hipóteses nulas.</p>
<p>Imagine um segundo exemplo. 300 flores foram fotografadas e classificadas pela cor e ao final foi obtido um total de 170 flores vermelhas e 130 flores verdes. Ao ler alguns trabalhos e analisar os resultados observados para outra região foi levantada a hipótese de que 70% das flores seriam vermelhas e 30% seriam verdes. Com base nesses dados podemos perguntar: As flores fotografadas confirmam os resultados esperados?</p>
<p>Vamos avaliar este caso, conforme fizemos acima.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">flores.observadas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">170</span>, <span class="dv">130</span>)</a>
<a class="sourceLine" id="cb86-2" data-line-number="2">flores.esperadas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.7</span>, <span class="fl">0.3</span>)</a></code></pre></div>
<p>Observe que igual nosso exemplo anterior criamos objetos <strong>flores.observadas</strong> e <strong>flores.esperadas</strong>. Note que a diferença está nos valores esperados, onde alteramos a proporção, que não é mais de 50% para cada, mas sim de 70% para um e 30% para outro, porém expressos em proporção (valores variam entre 0 e 1). Perceba, também, que os valores seguem a ordem em que foram inseridos, portanto o primeiro valor observado inserido corresponde ao primeiro valor esperado inserido e assim por diante.</p>
<p>Ao conduzir a análise temos o seguinte resultado</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">chisq.test</span>(<span class="dt">x =</span> flores.observadas, <span class="dt">p =</span> flores.esperadas)</a></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  flores.observadas
## X-squared = 25.397, df = 1, p-value = 4.667e-07</code></pre>
<p>Perceba que o valor do <span class="math inline">\(\chi\)</span>² aumentou em relação ao exemplo anterior e o <em>p-value</em> diminuiu para um valor bem próximo a 0. Este resultado indica que os valores observados de flores vermelhas e verdes não apresentam as proporções que se esperam de 70% e 30%. Portanto refutamos a hipótese nula de que elas se encontram nas proporções esperadas.</p>
<p>Vamos seguir em frente e olhar para um outro exemplo. Suponha que foram coletados 2660 indivíduos de siri em um estuário. Eles foram classificados em relação ao sexo e foram obtidos 1380 fêmeas e 1280 machos. Espera-se que a razão sexual desta espécie seja de 1:1 (50% para cada sexo). Os indivíduos amostrados confirmam o que é esperado?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">siris.observados &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1380</span>, <span class="dv">1280</span>)</a>
<a class="sourceLine" id="cb89-2" data-line-number="2">siris.esperados &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb89-3" data-line-number="3"></a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="kw">chisq.test</span>(<span class="dt">x =</span> siris.observados, <span class="dt">p =</span> siris.esperados)</a></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  siris.observados
## X-squared = 3.7594, df = 1, p-value = 0.05251</code></pre>
<p>Com este caso podemos observar que o valor do <span class="math inline">\(\chi\)</span>² indicou um <em>p-value</em> próximo a 0,05, indicando que temos de ter cuidado com as afirmações relativas a hipótese testada. Contudo, como o valor é &gt;0,5 podemos corroborar a hipotese nula e dizer que os valores observados para fêmeas e machos encontram-se dentro da proporção esperada de 1:1.</p>
<p>E se ao invés de 2 grupos tivessemos 3 ou mais. Como realizariamos o <span class="math inline">\(\chi\)</span>²? Vamos ver com um exemplo.</p>
<p>Imagine que você foi a uma floresta e classificou as árvores em altas, médias e baixas e contabilizou 55, 31 e 27 respectivamente. De acordo com a literatura é esperado que as proporções de árvores altas, médias e baixas seja de 1:1:1. Vamos analisar e verificar se podemos afirmar que o observado corrobora o esperado.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">arvores.observadas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">31</span>, <span class="dv">27</span>)</a>
<a class="sourceLine" id="cb91-2" data-line-number="2">arvores.esperadas &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb91-3" data-line-number="3"></a>
<a class="sourceLine" id="cb91-4" data-line-number="4"><span class="kw">chisq.test</span>(<span class="dt">x =</span> arvores.observadas, <span class="dt">p =</span> arvores.esperadas)</a></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  arvores.observadas
## X-squared = 12.177, df = 2, p-value = 0.002269</code></pre>
<p>Neste exemplo podemos perceber que a análise é igual a todos os casos anteriores, a diferença é que adicionamos um grupo a mais e consequentemente um valor a mais. Devido a essa mudança tivemos que dividir as probabilidades (objeto <strong>arvores.esperadas</strong>) em 3 valores e de igual probabilidade, já que o hipotetizado consistia em proporções iguais para os três grupos definidos. De acordo com o resultado obtido podemos perceber que o que foi observado não corrobora o esperado.</p>
<p>Vamos observar quais seriam as quantidades de árvores esperadas de acordo com as quantidades que observamos e as proporções que esperamos.</p>
<p>Para isso precisamos primeiramente inserir o resultado em um objeto e a seguir acessar os componentes desse objeto pelo operador matemático <strong>$</strong> (cifrão), seguido pelo objeto <strong>expected</strong> criado pela função <span style="color: blue;">chisq.test()</span>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">resultado &lt;-<span class="st"> </span><span class="kw">chisq.test</span>(<span class="dt">x =</span> arvores.observadas, <span class="dt">p =</span> arvores.esperadas)</a>
<a class="sourceLine" id="cb93-2" data-line-number="2"></a>
<a class="sourceLine" id="cb93-3" data-line-number="3">resultado<span class="op">$</span>expected</a></code></pre></div>
<pre><code>## [1] 37.66667 37.66667 37.66667</code></pre>
<p>Os exemplos acima tratam de avaliar o <span class="math inline">\(\chi\)</span>² em variáveis que apresentam dois ou mais grupos. Quando o grau de liberdade é 1 (dois grupos) e o número de observações é considerado baixo é sugerido a aplicação da correção de Yates. Quando o número de observações é elevado ela não distorce o resultado. O risco de se usar o <span class="math inline">\(\chi\)</span>² sem a correção de Yates consiste em inflar o valor de <span class="math inline">\(\chi\)</span>² e portanto diminuir o <em>p-value</em> o que nos levaria ao risco de rejeitarmos a hipótese nula quando ela é verdadeira (erro tipo I).</p>
<p>A função do <span class="math inline">\(\chi\)</span>², no pacote base do R, não realiza a correção de Yates para este teste, apenas para o próximo caso que iremos tratar (<span class="math inline">\(\chi\)</span>² para independência). Contudo ele oferece outro método para avaliação deste teste que consiste na simulação de Monte Carlo. Não entraremos em detalhes de como funciona este teste, mas o que alertamos é que se o número de observações utilizado é considerado baixo correções devem ser aplicadas. Embora os cálculos envolvidos para realização da correção de Yates não seja complicada sugerimos a leitura da literatura especializada.</p>
<p>Vamos verificar um exemplo onde a correção de Monte Carlo, a qual é possível de ser realizada de maneira rápida e prática no R, é aplicada.</p>
<p>Imagine que você foi em campo e contabilizou as espécies de cracas que identificou. Foram contabilizados 12 cracas da espécie A e 24 da espécie B. Trabalhos anteriores demonstraram que ambas as espécies encontram-se na proporção de 1:1. Aplicando a simulação de Monte Carlo o número de indivíduos observados de ambas as espécies corroboram o esperado?</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">N.especies &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">24</span>)</a>
<a class="sourceLine" id="cb95-2" data-line-number="2">prop.especies &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3"></a>
<a class="sourceLine" id="cb95-4" data-line-number="4"><span class="kw">chisq.test</span>(<span class="dt">x =</span> N.especies, <span class="dt">p =</span> prop.especies, <span class="dt">simulate.p.value =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities
## 
## data:  N.especies
## X-squared = 4, df = 1, p-value = 0.0455</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" data-line-number="1"><span class="kw">chisq.test</span>(<span class="dt">x =</span> N.especies, <span class="dt">p =</span> prop.especies, <span class="dt">simulate.p.value =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## 
##  Chi-squared test for given probabilities with simulated p-value (based
##  on 2000 replicates)
## 
## data:  N.especies
## X-squared = 4, df = NA, p-value = 0.06947</code></pre>
<p>Basta usarmos o argumento “simulate.p.value” e indicar “FALSE” quando não queremos a simulação de Monte Carlo, ou apenas omitirmos este argumento, ou usar este argumento e indicar “TRUE” o qual realiza a simulação de Monte Carlo. Verifique que com a aplicação desta simulação o <em>p-value</em> aumenta indicando que torna mais dificil rejeitarmos a hipótese nula. Após aplicarmos a correção na nossa análise podemos afirmar que não há diferença na quantidade de cracas observadas em relação as proporções esperadas, para ambas as espécies de cracas.</p>
<p>Relembrando. Sempre tome cuidado com afirmações! Principalmente quando o número de observações é baixo. Mesmo que o teste estatístico indique diferenças, uma baixa quantidade de observações devem ser analisadas cuidadosamente, no entanto devemos aplicar correções matemáticas nestes casos.</p>
</div>
<div id="chi-para-independência" class="section level2">
<h2><span class="header-section-number">3.2</span> <span class="math inline">\(\chi\)</span>² para independência</h2>
<p>Realizamos este teste quando objetivamos saber se a frequência dos grupos de uma variável é independente de outra variável.</p>
<p>Diferente do primeiro caso de <span class="math inline">\(\chi\)</span>² que abordamos, este lida com duas variáveis categóricas ao invés de uma. Portanto é necessário o desenvolvimento de uma tabela de contigência.</p>
<p>A tabela de contigência consiste em uma tabela com o número de observações referentes as duas variáveis selecionadas. Veremos alguns exemplos abaixo.</p>
<p>Para o momento. Veja o sumário abaixo no qual detalhamos as principais características desta análise.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:tab2qui">Tabela 3.2: </span>Principais características do qui-quadrado para independência
</caption>
<thead>
<tr>
<th style="text-align:left;">
Atributos
</th>
<th style="text-align:left;">
Características
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Tipo de variável
</td>
<td style="text-align:left;width: 30em; ">
Categórica.
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Quantidade de variáveis
</td>
<td style="text-align:left;width: 30em; ">
2 ou mais.
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Hipótese nula
</td>
<td style="text-align:left;width: 30em; ">
As proporções relativas de uma variável são independentes de uma segunda variável.
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Fórmula
</td>
<td style="text-align:left;width: 30em; ">
Para uma tabela 2 $$2 temos: <span class="math display">\[\chi^{2} = \frac{n(f_{11}f_{22}-f_{12}f_{21})^2}{R_{1}R_{2}C_{1}C_{2}}\]</span> Onde n é onúmero total de observações; <span class="math inline">\(f_{11}\)</span> é o valor da primeira linha e primeira coluna; <span class="math inline">\(f_{22}\)</span> é o valor da segunda linha e segunda coluna; <span class="math inline">\(f_{12}\)</span> é o valor da primeira linha e da segunda coluna; <span class="math inline">\(f_{21}\)</span> é o valor da segunda linha e primeira coluna; <span class="math inline">\(R_{1}\)</span> é a soma da primeira linha; <span class="math inline">\(R_{2}\)</span> é a soma da segunda linha; <span class="math inline">\(C_{1}\)</span> é a soma da primeira coluna e <span class="math inline">\(C_{2}\)</span> é a soma da segunda coluna.
</td>
</tr>
<tr>
<td style="text-align:left;width: 10em; font-weight: bold;">
Observação
</td>
<td style="text-align:left;width: 30em; ">
Como característica intrinseca a este teste é necessário a construção da tabela de contigência.
</td>
</tr>
</tbody>
</table>
<p>Imagine a seguinte situação: Insetos foram coletados, ao acaso, em uma região costeira. Todos os insetos foram avaliados quanto a espécie e a presença de parasitas. Os seguintes valores foram obtidos: 55 indivíduos da espécie A com parasita, 75 indivíduos da espécie A sem parasita, 90 indivíduos da espécie B com parasita e 110 indivíduos da espécie B sem parasita. Foi levantada a hipótese nula de que a quantidade de indivíduos infectados pelo parasita é o mesmo para ambas as espécies.</p>
<p>Vamos começar criando uma matriz<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> com esses valores, onde as linhas corresponderão as espécies, as colunas a presença/ausência do parasita e os seus elementos corresponderão a quantidade de indivíduos dada as condições (espécie e parasita).</p>
<p>Para construir nossos dados utilizaremos a função <span style="color: blue;">matrix</span>, com os argumentos “data”, onde adicionaremos os elementos que estarão presentes, “ncol” onde definiremos a quantidade de colunas e “byrow” onde definiremos que os valores presentes no argumento “data” serão inseridos em ordem por linha, neste caso a função começará preenchendo a primeira linha da primeira coluna, segunda linha da primeira coluna, primeira linha da segunda coluna e segunda linha da segunda coluna. Guardaremos nossa matriz criada em um objeto chamado <strong>dados</strong>. Utilizaremos as funções <span style="color: blue;">rownames()</span> e <span style="color: blue;">colnames()</span> a fim de definir os nomes das linhas e colunas da nossa matriz para melhor visualização. A seguir iremos visualizar o objeto <strong>dados</strong>.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" data-line-number="1">dados &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> <span class="kw">c</span>(<span class="dv">55</span>, <span class="dv">75</span>, <span class="dv">90</span>, <span class="dv">110</span>), <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb99-2" data-line-number="2"><span class="kw">rownames</span>(dados) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Espécie A&quot;</span>, <span class="st">&quot;Espécie B&quot;</span>)</a>
<a class="sourceLine" id="cb99-3" data-line-number="3"><span class="kw">colnames</span>(dados) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Com parasita&quot;</span>, <span class="st">&quot;Sem parasita&quot;</span>)</a>
<a class="sourceLine" id="cb99-4" data-line-number="4">dados</a></code></pre></div>
<pre><code>##           Com parasita Sem parasita
## Espécie A           55           75
## Espécie B           90          110</code></pre>
<p>Pronto nossa tabela de contigência está criada. Vamos seguir para a análise</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" data-line-number="1"><span class="kw">chisq.test</span>(<span class="dt">x =</span> dados)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  dados
## X-squared = 0.13543, df = 1, p-value = 0.7129</code></pre>
<p>Ao executarmos a função <span style="color: blue;">chisq.test()</span> utilizando apenas a matriz como objeto do argumento “x” ele nos retorna o <span class="math inline">\(\chi\)</span>² com a correção de Yates. O que é sugerido para quando estamos lidando com matrizes <span class="math inline">\(2 \times 2\)</span>. No geral o resultado é similar ao que executamos no tópico anterior.</p>
<p>Uma atenção deve ser dada ao grau de liberdade o qual indica o valor de 1. O cálculo do grau de liberdade consiste no número de linhas menos um multiplicado pelo número de colunas menos um. Como temos 2 linhas e 2 colunas o grau de liberdade será: <span class="math inline">\((2-1)*(2-1) = 1*1 = 1\)</span>.</p>
<p>De acordo com o resultado obtido pelo teste não podemos refutar nossa hipótese nula. Portanto dizemos que a proporção da população infectada pelo parasita é a mesma nas duas espécies.</p>
<p>Vejamos um segundo exemplo.</p>
<p>Durante 2 anos camarões foram coletados, em um estuário, e todos eles foram sexados em machos e fêmeas. Objetivou-se com esses dados saber se há algum desvio da razão sexual entre os anos.</p>
<p>Vamos começar desenvolvendo um conjunto de dados na forma de planilha, que é como seus dados devem estar planilhados e vamos ensina-lo a construir uma tabela de contingência a partir desses dados.</p>
<p>Execute o código abaixo. Não se preocupe, no momento, com as funções novas utilizadas. A única função diferente é <span style="color: blue;">rep()</span> que repete um determinado elemento n vezes. No código abaixo, estaremos repetindo o elemento “Ano 1” 150 vezes e o elemento “Ano 2” 225 vezes e concatenaremos estes elementos por meio da função <span style="color: blue;">c()</span> e guardando-o no objeto <strong>ano</strong> faremos o mesmo para o objeto <strong>sexo</strong> onde concatenaremos a repetição do elemento “macho” 55 vezes, seguido por “fêmea” 95 vezes, seguido novamente por “macho” 105 vezes e por fim “fêmea” 120 vezes. Após isso uniremos os dois objetos <strong>ano</strong> e <strong>sexo</strong> por meio da função <span style="color: blue;">cbind()</span> e diremos que isso consiste em um objeto da classe <em>data frame</em> por meio da função <span style="color: blue;">data.frame()</span> e guardaremos esse resultado em um objeto denominado <strong>dados</strong>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" data-line-number="1">ano &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Ano 1&quot;</span>, <span class="dv">150</span>), <span class="kw">rep</span>(<span class="st">&quot;Ano 2&quot;</span>, <span class="dv">225</span>))</a>
<a class="sourceLine" id="cb103-2" data-line-number="2">sexo &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;macho&quot;</span>, <span class="dv">55</span>), <span class="kw">rep</span>(<span class="st">&quot;fêmea&quot;, 95), rep(&quot;</span>macho<span class="st">&quot;, 105), rep(&quot;</span>fêmea&quot;, <span class="dv">120</span>))</a>
<a class="sourceLine" id="cb103-3" data-line-number="3"></a>
<a class="sourceLine" id="cb103-4" data-line-number="4">dados &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">cbind</span>(ano, sexo))</a></code></pre></div>
<p>Vamos visualizar nossos dados. Para isso podemos usar a função <span style="color: blue;">head()</span> que mostra no console as primeiras linhas desse <em>data frame</em>.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw">head</span>(dados)</a></code></pre></div>
<pre><code>##     ano  sexo
## 1 Ano 1 macho
## 2 Ano 1 macho
## 3 Ano 1 macho
## 4 Ano 1 macho
## 5 Ano 1 macho
## 6 Ano 1 macho</code></pre>
<p>Agora vamos, a partir de <strong>dados</strong> construir uma tabela de contigência. Para isso vamos utilizar a função <span style="color: blue;">table()</span> e guardar seu resultado em um objeto chamado <strong>tab.cont</strong>. A seguir iremos visualizar nossa tabela de contingência chamando <strong>tab.cont</strong></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1">tab.cont &lt;-<span class="st"> </span><span class="kw">table</span>(dados)</a>
<a class="sourceLine" id="cb106-2" data-line-number="2">tab.cont</a></code></pre></div>
<pre><code>##        sexo
## ano     fêmea macho
##   Ano 1    95    55
##   Ano 2   120   105</code></pre>
<p>Vamos agora realizar o qui-quadrado de nossos dados.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="kw">chisq.test</span>(tab.cont)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  tab.cont
## X-squared = 3.2817, df = 1, p-value = 0.07006</code></pre>
<p>Pronto! Como podem ver, a representação do resultado é similar ao exemplo acima. Contudo nossos dados são diferentes e portanto nossa hipótese nula é diferente.</p>
<p>Nossa hipótese nula pode ser escrita de três formas. Vejamos os 3 exemplos abaixo:</p>
<ul>
<li>H0: Na população amostrada a proporção de machos e fêmeas é independente do ano;</li>
<li>H0: Na população amostrada a razão sexual dos camarões é a mesma entre os anos;</li>
<li>H0: A proporção de camarões entre os anos é a mesma para ambos os sexos;</li>
</ul>
<p>Como o teste resultou em um <em>p-value</em> maior que 0,05 podemos dizer, por essa via, que corroboramos nossa hipótese nula.</p>
<p>Neste ponto é bom relembramos da importância do número de observações de cada grupo. Se este número for pequeno, incertezas podem ser geradas e ajustes devem ser feitos. Contudo, para definir o que é um número baixo de observações sigamos para o cálculo sugerido por Zar (2010)<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> o qual define como: <span class="math inline">\(n = 6rc\)</span>.</p>
<p>Onde, n é o número de observações mínimo de cada grupo, r é o número de linhas (<em>rows</em>) e c é o número de colunas (<em>column</em>). Dessa forma, em uma tabela de contigência do tipo <span class="math inline">\(2 \times 2\)</span> o número de observações mínimo para cada grupo deve ser de: <span class="math inline">\(n = 6 \times (2) \times (2) = 24\)</span>. Ou seja, 24 observações.</p>
<p>Esta análise pode ser conduzida, também, quando lidamos com mais de um grupo em uma categoria e neste caso teriamos uma tabela de contigência <span class="math inline">\(2 \times 3\)</span>, <span class="math inline">\(2 \times 4\)</span>, <span class="math inline">\(3 \times 3\)</span> e assim por diante. Vamos ver um exemplo.</p>
<p>Três pesquisadores analisaram fotografias de espécies bentônicas em um costão objetivando avaliar a abundância de duas espécies, uma introduzida e uma nativa. Considere todo o processo amostral similar e que os pesquisadores avaliaram as mesmas fotografias. Neste caso nossa hipótese nula é que a proporção entre as espécies é similar independentemente dos pesquisadores.</p>
<p>Vamos construir nossa matriz de uma outra forma.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1">pesquisadores &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;pesquisador 1&quot;</span>, <span class="st">&quot;pesquisador 2&quot;</span>, <span class="st">&quot;pesquisador 3&quot;</span>)</a>
<a class="sourceLine" id="cb110-2" data-line-number="2">sp.nativa &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">70</span>, <span class="dv">79</span>, <span class="dv">38</span>)</a>
<a class="sourceLine" id="cb110-3" data-line-number="3">sp.introduzida &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">84</span>, <span class="dv">95</span>, <span class="dv">80</span>)</a>
<a class="sourceLine" id="cb110-4" data-line-number="4">dados &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(sp.nativa, sp.introduzida), <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">byrow =</span> T)</a>
<a class="sourceLine" id="cb110-5" data-line-number="5"><span class="kw">colnames</span>(dados) &lt;-<span class="st"> </span>pesquisadores</a>
<a class="sourceLine" id="cb110-6" data-line-number="6"><span class="kw">rownames</span>(dados) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Espécie nativa&quot;</span>, <span class="st">&quot;Espécie introduzida&quot;</span>)</a>
<a class="sourceLine" id="cb110-7" data-line-number="7">dados</a></code></pre></div>
<pre><code>##                     pesquisador 1 pesquisador 2 pesquisador 3
## Espécie nativa                 70            79            38
## Espécie introduzida            84            95            80</code></pre>
<p>Os dados foram construídos passo a passo. Vamos analisar e verificar o resultado.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw">chisq.test</span>(dados)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  dados
## X-squared = 6.2322, df = 2, p-value = 0.04433</code></pre>
<p>Repare que há algo diferente, como realizamos a análise em uma tabela <span class="math inline">\(2 \times 3\)</span> por padrão a função <span style="color: blue;">chisq.test()</span> não realiza a correção de Yates. Pois não é necessário.</p>
<p>Analisando o resultado podemos inferir que as proporções observadas de espécies nativas e introduzidas são diferentes em função do pesquisador. Ou seja, rejeitamos nossa hipótese nula de que as proporções são similares. Contudo o <em>p-value</em> foi bem próximo ao limiar de 0,05. Podemos nos aprofundar na questão e nos perguntar onde está essa diferença? Entre o pesquisador 1 e o pesquisador 2 ou entre outra dupla de pesquisadores? Como observamos isso?</p>
<p>Para responder essa pergunta em específico, vamos subdividir nossa tabela de contigência para todos os pares de observações e armazena-los em outros objetos.</p>
<p>Para isso criaremos tabelas <span class="math inline">\(2 \times 2\)</span> para cada par de comparações. Repare que usaremos a nossa tabela <strong>dados</strong> originalmente criada seguida por colchetes e dentro do colchetes inserimos virgula e menos o número referente a coluna. O colchetes após o nome dos dados nos permite acessar as linhas e colunas de um conjunto de dados quaisquer com isso podemos remove-las ou seleciona-las. Qualquer número antes da virgula indica a linha e qualquer número após a vírgula indica a coluna. O sinal de menos indica que vamos remover e se não colocarmos sinal indica que iremos selecionar o valor especificado. No primeiro caso onde inserimos “-3” após a virgula estamos indicando que vamos remover a terceira coluna do objeto dados e armazenar este resultado em um novo objeto chamado <strong>p1.p2</strong>. O mesmo raciocínio segue nos demais casos.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1">p1.p2 &lt;-<span class="st"> </span>dados [, <span class="dv">-3</span>]</a>
<a class="sourceLine" id="cb114-2" data-line-number="2">p1.p3 &lt;-<span class="st"> </span>dados [, <span class="dv">-2</span>]</a>
<a class="sourceLine" id="cb114-3" data-line-number="3">p2.p3 &lt;-<span class="st"> </span>dados [, <span class="dv">-1</span>]</a></code></pre></div>
<p>Sabendo isso vamos realizar a função <span style="color: blue;">chisq.test()</span> para cada par de observações e analisar seu resultado.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" data-line-number="1"><span class="kw">chisq.test</span>(p1.p2)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  p1.p2
## X-squared = 0, df = 1, p-value = 1</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" data-line-number="1"><span class="kw">chisq.test</span>(p1.p3)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  p1.p3
## X-squared = 4.3623, df = 1, p-value = 0.03674</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" data-line-number="1"><span class="kw">chisq.test</span>(p2.p3)</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  p2.p3
## X-squared = 4.5663, df = 1, p-value = 0.03261</code></pre>
<p>Repare que não há diferenças entre a proporção de espécies observadas entre os pesquisadores 1 e 2. Mas entre o pesquisador 3 e os demais há diferença. Isto indica que é o pesquisador 3 que destoa dos demais em relação a observação de espécies nativas e introduzidas.</p>
<p>Quando observamos todo o conjunto de dados não observamos esta característica, mas ao separarmos os dados a diferença fica evidenciada.</p>
<p>Uma prática comum nesta análise é demonstrar o resultado por meio gráfico. Portanto, vamos observar como representar graficamente este último exemplo.</p>
<p>Primeiro vamos transformar nossa tabela de contigência em uma tabela no qual os valores irão corresponder a proporções relativas. Para isso vamos usar a função <span style="color: blue;">prop.table()</span> e armazenar este resultado em um objeto chamado <strong>tabela</strong>.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" data-line-number="1">tabela &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="dt">x =</span> dados)</a>
<a class="sourceLine" id="cb121-2" data-line-number="2">tabela</a></code></pre></div>
<pre><code>##                     pesquisador 1 pesquisador 2 pesquisador 3
## Espécie nativa          0.1569507     0.1771300    0.08520179
## Espécie introduzida     0.1883408     0.2130045    0.17937220</code></pre>
<p>Como podem ver o resultado deste nosso passo nos retornou uma tabela de proporções em relação ao total. Podemos transformar-la em percentual, basta multiplicarmos a tabela por 100. Vamos ver o processo</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" data-line-number="1">tabela &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="dt">x =</span> dados)<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb123-2" data-line-number="2">tabela</a></code></pre></div>
<pre><code>##                     pesquisador 1 pesquisador 2 pesquisador 3
## Espécie nativa           15.69507      17.71300      8.520179
## Espécie introduzida      18.83408      21.30045     17.937220</code></pre>
<p>Pensando um pouco na nossa análise e no que ela avalia. O <span class="math inline">\(\chi\)</span>² está avaliando as proporções relativas entre os grupos de uma dada variável, neste último caso a proporção das espécie em relação aos pesquisadores. Então a tabela de proporções ou percentual que nos interessa é a relação entre a espécie nativa e introduzida por pesquisador. A função <span style="color: blue;">prop.table()</span> nos permite definir isso por meio do argumento “<em>margin</em>”, vamos verificar o resultado olhando para o resultado em percentual.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" data-line-number="1"><span class="kw">prop.table</span>(<span class="dt">x =</span> dados, <span class="dt">margin =</span> <span class="dv">1</span>)<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>##                     pesquisador 1 pesquisador 2 pesquisador 3
## Espécie nativa           37.43316      42.24599      20.32086
## Espécie introduzida      32.43243      36.67954      30.88803</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" data-line-number="1"><span class="kw">prop.table</span>(<span class="dt">x =</span> dados, <span class="dt">margin =</span> <span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>##                     pesquisador 1 pesquisador 2 pesquisador 3
## Espécie nativa           45.45455       45.4023      32.20339
## Espécie introduzida      54.54545       54.5977      67.79661</code></pre>
<p>Como podem visualizar, se usarmos “<em>margin</em> = 1” ele nos retorna os valores em função das linhas (espécies), se utilizarmos “<em>margin</em> = 2” ele nos retorna os valores em função das colunas (pesquisadores).</p>
<p>Vamos utilizar “<em>margin</em> = 2” para construir nossa tabela e plotarmos nosso gráfico (Figura <a href="qui-quadrado-chi.html#fig:bar-tab">3.1</a>).</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" data-line-number="1">tabela &lt;-<span class="st"> </span><span class="kw">prop.table</span>(<span class="dt">x =</span> dados, <span class="dt">margin =</span> <span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span></a>
<a class="sourceLine" id="cb129-2" data-line-number="2"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">13</span>))</a>
<a class="sourceLine" id="cb129-3" data-line-number="3"><span class="kw">barplot</span>(tabela, </a>
<a class="sourceLine" id="cb129-4" data-line-number="4">        <span class="dt">xlab =</span> <span class="st">&quot;Percentual de espécies&quot;</span>,</a>
<a class="sourceLine" id="cb129-5" data-line-number="5">        <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;darkblue&quot;</span>), </a>
<a class="sourceLine" id="cb129-6" data-line-number="6">        <span class="dt">legend.text =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb129-7" data-line-number="7">        <span class="dt">args.legend =</span> <span class="kw">list</span>(<span class="dt">x =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">inset =</span> <span class="fl">-0.5</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:bar-tab"></span>
<img src="livroR-1.0_files/figure-html/bar-tab-1.png" alt="Gráfico de barras sobrepostas indicando o percentual relativo da observação de espécies nativas (cor vermelha) e introduzidas (cor azul), por pesquisador." width="768" />
<p class="caption">
Figura 3.1: Gráfico de barras sobrepostas indicando o percentual relativo da observação de espécies nativas (cor vermelha) e introduzidas (cor azul), por pesquisador.
</p>
</div>
<p>Como podem ver o nosso gráfico foi realizado. Mas adicionamos uma série de comandos novos. Vamos explica-los passo a passo.</p>
<p>Primeiro contruímos a tabela com os dados em percentuais relativos ao pesquisador e o armazenamos em um objeto chamado tabela.</p>
<p>Posteriormente utilizamos uma função chamada <span style="color: blue;">par()</span> com o argumento “mar” no qual concatenamos 4 valores. Esta função juntamente com esse argumento permite que redimensionemos a janela gráfica. Os quatro valores concatenados referem-se as margens inferior, esquerda, superior e direita, respectivamente.</p>
<p>Nosso último passo é a nossa já conhecida função <span style="color: blue;">barplot()</span>, onde inserimos como primeiro valor o objeto que contem os dados que queremos graficar <strong>tabela</strong>, seguido pelo argumento “col” que define as cores de acordo com as linhas da tabela, por sua vez definimos se a legenda será plotada com o argumento “<em>legend.text</em>” e por último indicamos a posição e o formato da legenda por meio do argumento “<em>args.lengend</em>”. Neste último argumento precisamos inserir a função <span style="color: blue;">list()</span> na qual indicamos a posição da legenda pelo argumento “x”, o argumento “bty” o qual define que a legenda não tera uma caixa desenhada no seu entorno e o argumento “<em>inset</em>” que define a posição da legenda em relação ao eixo x.</p>
</div>
<div id="considerações-1" class="section level2">
<h2><span class="header-section-number">3.3</span> Considerações</h2>
<p>Durante nosso percurso neste capítulo realizamos etapas que consistem na construção dos dados no próprio programa do R e a condução da análise do qui-quadrado para ajuste das frequências e para a independência. A construção dos dados tem como resultado final um objeto similar a planilha de dados que deve ser importada, caso já a tenha preparado, e juntamente com a sumarização dos dados temos as mesmas etapas trabalhadas no capítulo anterior. A partir daí temos a condução da análise estatística pelo qui-quadrado. Um resumo gráfico das etapas pode ser observado aqui (Figura <a href="qui-quadrado-chi.html#fig:resumo2">3.2</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:resumo2"></span>
<img src="figures%20print/resumo2.png" alt="Resumo dos passos abordados no capítulo: da preparação dos dados até a análise dos dados." width="100%" />
<p class="caption">
Figura 3.2: Resumo dos passos abordados no capítulo: da preparação dos dados até a análise dos dados.
</p>
</div>
</div>
<div id="exercícios-2" class="section level2">
<h2><span class="header-section-number">3.4</span> Exercícios</h2>
<ol style="list-style-type: decimal">
<li><p>Durante um longo período de observação sobre a trafego de carros na praia um pesquisador percebeu que durante a tarde o número de carros circulando era maior que durante a manhã. Ele resolveu tomar nota da quantidade de carros que passava em um determinado trecho da praia, durante vários dias, em ambos os períodos (manhã e tarde) e registrou, no total, os seguintes valores: 550 carros durante a manhã 620 carros durante a tarde. Considerando a observação do pesquisador e os valores por ele tomados, podemos corroborar ou refutar sua observação? Desenvolva a análise do qui-quadrado.</p></li>
<li>Ao registrar o número de carros o pesquisador também registrou os dias da semana em que foram feitas as observações e obteve os seguintes valores:</li>
</ol>
<ul>
<li>Manhã de Quarta-feira: 130</li>
<li>Manhã de Sexta-feira: 420</li>
<li>Tarde de Quarta-feira: 178</li>
<li>Tarde de Sexta-feira: 442
A partir desses registros podemos dizer que o número de carros por período do dia (manhã e tarde) é independente do dia da semana (Quarta-feira e Sexta-feira)?</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li><p>Considerando os dados do exercício anterior. Obtenha a tabela com os dados em percentuais do número de carros por período do dia em relação aos dias da semana.</p></li>
<li><p>Defina erro do tipo 1 e erro do tipo 2. Considerando o exercício 2. Qual dos erros (tipo 1 ou tipo 2) é assumido a um nível de confiança de 95%?</p></li>
<li><p>Plote um gráfico com a tabela obtida no exercício 3.</p></li>
</ol>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="13">
<li id="fn13"><p>Vetores é uma estrutura básica do R que consiste em um objeto que contêm elementos de mesma classe. Se realizarmos o comando <span style="color: green;">c(1, 2, 3)</span>, criamos um vetor, mas não um objeto. Se criarmos o seguinte: <span style="color: green;">teste &lt;- c(1, 2, 3)</span> estaremos criando um objeto do tipo vetor.<a href="qui-quadrado-chi.html#fnref13" class="footnote-back">↩</a></p></li>
<li id="fn14"><p>É um conjunto de elementos com estrutura n-dimensional, ou seja, com várias linhas e colunas, onde todos os seus elementos são de mesmo tipo (númerico, inteiro, fator, caracter etc).<a href="qui-quadrado-chi.html#fnref14" class="footnote-back">↩</a></p></li>
<li id="fn15"><p>Zar, J. H. (2010). Biostatistical analysis (5th ed.). Upper Saddle River, N.J.: Prentice-Hall/Pearson.<a href="qui-quadrado-chi.html#fnref15" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="importar-organizar-e-sumarizar-os-dados.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="teste-t.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["livroR-1.0.pdf", "livroR-1.0.docx", "livroR-1.0.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
